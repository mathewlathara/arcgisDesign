{% load static %}
<html>

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="{% static 'admin-lte/assets/css/logincss/login.css' %}" rel="stylesheet">
</head>

<body>
    <div id="container" class="container">
        <!-- FORM SECTION -->
        <div class="row">
            <!-- SIGN UP -->

            <div class="col align-items-center flex-col sign-up">
                <div class="form-wrapper align-items-center">
                    <div class="form sign-up">
                        <form id="signupform">
                            {% csrf_token %}
                            <div class="input-group">
                                <i class='bx bx-mail-send'></i>
                                <input type="email" placeholder="Email" name="emailaddress" id="emailaddress">
                            </div>
                            <div class="input-group">
                                <i class='bx bxs-lock-alt'></i>
                                <input type="password" placeholder="Password" name="password" id="password">
                            </div>
                            <div class="input-group">
                                <i class='bx bxs-lock-alt'></i>
                                <input type="password" placeholder="Confirm password" id="confirmpassword">
                            </div>
                            <button id="addnewuser">
                                Sign up
                            </button>
                            <p style="color: green;" id="usercreated">User created successfully</p>
                            <p style="color: red;" id="useralreadyexitsid">User already exists</p>
                            <p>
                                <span>
                                    Already have an account?
                                </span>
                                <b onclick="toggle()" class="pointer">
                                    Sign in here
                                </b>
                            </p>
                        </form>
                    </div>
                </div>

            </div>

            <!-- END SIGN UP -->
            <!-- SIGN IN -->
            <div class="col align-items-center flex-col sign-in">
                <div class="form-wrapper align-items-center">
                    <div class="form sign-in">
                        <div class="input-group">
                            <i class='bx bxs-user'></i>
                            <input type="text" placeholder="Email">
                        </div>
                        <div class="input-group">
                            <i class='bx bxs-lock-alt'></i>
                            <input type="password" placeholder="Password">
                        </div>
                        <button>
                            Sign in
                        </button>
                        <p>
                            <b>
                                Forgot password?
                            </b>
                        </p>
                        <p>
                            <span>
                                Don't have an account?
                            </span>
                            <b onclick="toggle()" class="pointer">
                                Sign up here
                            </b>
                        </p>
                    </div>
                </div>
                <div class="form-wrapper">

                </div>
            </div>
            <!-- END SIGN IN -->
        </div>
        <!-- END FORM SECTION -->
        <!-- CONTENT SECTION -->
        <div class="row content-row">
            <!-- SIGN IN CONTENT -->
            <div class="col align-items-center flex-col">
                <div class="text sign-in">
                    <h2>
                        Welcome
                    </h2>

                </div>
                <div class="img sign-in">

                </div>
            </div>
            <!-- END SIGN IN CONTENT -->
            <!-- SIGN UP CONTENT -->
            <div class="col align-items-center flex-col">
                <div class="img sign-up">

                </div>
                <div class="text sign-up">
                    <h2>
                        Join with us
                    </h2>

                </div>
            </div>
            <!-- END SIGN UP CONTENT -->
        </div>
        <!-- END CONTENT SECTION -->
    </div>
    <script src="{% static 'admin-lte/assets/js/loginjs/login.js' %}"></script>
    <script src="{% static 'admin-lte/assets/js/jquery/jquery.min.js' %}"></script>

    <script>
        $(document).ready(function () {
            $("#useralreadyexitsid").hide();
            $("#usercreated").hide();

            $(document).on('click', '#addnewuser', function (e) {
                $("#useralreadyexitsid").hide();
                $("#usercreated").hide();
                e.preventDefault();
                var emailaddress = $("#emailaddress").val();
                var password = $("#password").val();
                var confirmpassword = $("#confirmpassword").val();
                if (emailaddress === '' || password === '' || confirmpassword === '') {
                    alert("All the fields must be filled");
                } else {
                    if (password === confirmpassword) {
                        $.ajax({
                            type: 'POST',
                            url: 'http://localhost:8000/addNewUser/',
                            data: $("#signupform").serialize(),
                            success: function (data) {
                                if(data.status === "exists"){
                                    $("#useralreadyexitsid").show();
                                }else if(data.status === "success"){
                                    $("#usercreated").show();
                                }
                            },
                            error: function (error) {
                                alert("This is the error---->" + JSON.stringify(error));
                            }
                        });
                    } else {
                        alert("Both passwords don't match");
                    }

                }
                console.log("I am in here");
            });
        });
    </script>
</body>

</html>